
## Булевы операции в виде нейроной

Рассмотрим задачу об операторе "НЕ". Оператор "НЕ" — это унарная булева функция. Что это значит? Это значит, что эта функция принимает всего один аргумент. При этом этот аргумент может быть либо $0$, либо $1$.

Оператор "НЕ" задаётся таблицей истинности. Поскольку у булевой функции может быть только два типа входных значений — $0$ и $1$, то в этой таблице будет всего две строки.

$$
\begin{array}{c|c}
x & \text{not}(x) \\
\hline
1 & 0 \\
0 & 1 \\
\end{array}
$$

Если вход в оператор "НЕ" равен $1$, то оператор "НЕ" должен возвращать $0$. Если вход в оператор "НЕ" равен $0$, то оператор "НЕ" должен возвращать $1$.

Представим этот оператор в виде одного нейрона. Как сделать такой нейрон? У этого нейрона должен быть один вход, потому что у оператора "НЕ" один аргумент, и один выход, потому что оператор "НЕ" возвращает одно значение. Итак, вот схема этого нейрона.

Какой выбрать функцию активации? Для простоты выберем функцию активации пороговую, как это было уже сделано ранее. Тогда модель нейрона имеет вид:

$$
y = f(w x + b)
$$

где $f$ — пороговая функция активации:
$$
f(z) = 
\begin{cases}
1, & \text{если } z > 0, \\
0, & \text{если } z \leq 0.
\end{cases}
$$

Итак, задача: подберите два параметра: вес $w$ и смещение $b$, так, чтобы получившийся нейрон выполнял операцию "НЕ". То есть:

- $y = 0$, когда $x = 1$,
- $y = 1$, когда $x = 0$.

На самом деле, этих значений бесконечное множество. Но для примера, $w$ я возьму равным $-1$, а $b$ я возьму равным $0.5$.

Подставим $x=1$. Что здесь получится?
Когда $x$ равен $1$, то $x$ умноженный на вес $-1$ будет равен $-1$. Если мы прибавим к полученному значению $b$, то получим $-0.5$. Результатом функции активации будет $0$, поскольку аргумент функции активации — это отрицательное число.

Рассмотрим другой вариант, когда вход равен $0$.
В этом случае $0$ умножить на $-1$ — это $0$. $0$ плюс $0.5$ будет $0.5$. Соответственно, результатом работы функции активации будет $1$, потому что в этом случае аргумент функции активации положительный.

Таким образом, мы с вами сделали нейрон, который выполняет операцию "НЕ".

Стоит отметить, что на самом деле параметров, которые соответствуют этому нейрону, — бесконечно много. Можно вывести систему неравенств, которая задаёт множество таких нейронов, которые выполняют операцию "НЕ".

---

Итак, в прошлый раз мы рассмотрели с вами задачу для нейрона "НЕ". В этот раз мы рассмотрим с вами точно такую же задачу, только, на этот раз, для логической операции "И". 

Логическая операция "И" — это **бинарная булева операция**. Что это значит?
- "Бинарная" — значит, что операция "И" принимает два аргумента $x_1$ и $x_2$.
- "Булева" — значит, что каждый из аргументов может принимать только два значения: $0$ и $1$.

Поскольку у нас два значения и две переменные, всего комбинаций входных параметров $2^2 = 4$. Таким образом, таблица истинности будет состоять из четырёх строк:

$$
\begin{array}{cc|c}
x_1 & x_2 & x_1 \ \text{И} \ x_2 \\
\hline
0 & 0 & 0 \\
0 & 1 & 0 \\
1 & 0 & 0 \\
1 & 1 & 1 \\
\end{array}
$$

Если у нас на вход оператору "И" передаются две $1$, то оператор "И" будет выдавать $1$. В остальных случаях результатом должен быть $0$.

Итак, как же сделать такой нейрон?
- У этого нейрона должно быть **два входа**, потому что у функции "И" два аргумента.
- У этого нейрона должен быть **один выход**, потому что результат операции "И" — одно значение.

Нейрон будет выглядеть вот так:

$$
y = f(w_1 x_1 + w_2 x_2 + b)
$$

И у него будет два веса: $w_1$ будет взвешивать первый вход, $w_2$ будет взвешивать второй вход, и будет ещё значение смещения $b$. Функцией активации будет пороговая функция:

$$
f(z) = 
\begin{cases}
1, & \text{если } z > 0, \\
0, & \text{если } z \leq 0.
\end{cases}
$$

Задача: найдите $w_1$, $w_2$ и $b$.

---

Итак, как же найти такие параметры? У нас есть четыре условия, каждое из этих условий накладывает некоторые ограничения на параметры, каждое условие будет соответствовать некоторому неравенству.

Если выход из операции "И" равен $1$, это означает, что вход в функцию активации должен быть положительным. В остальных же случаях, когда выход из операции "И" равен $0$, вход в функцию активации должен быть отрицательным.

Соответственно, неравенства будут следующими:
1. $w_1 \cdot 0 + w_2 \cdot 0 + b \leq 0$
2. $w_1 \cdot 0 + w_2 \cdot 1 + b \leq 0$
3. $w_1 \cdot 1 + w_2 \cdot 0 + b \leq 0$
4. $w_1 \cdot 1 + w_2 \cdot 1 + b > 0$

Можно решать эту систему неравенств явно, но мы сейчас подумаем, как решить её графически.

Графически её решить можно следующим образом. Отложим в координатах $x_1$, $x_2$ все возможные точки, которые могут входить в этот нейрон. Их всего четыре:
$(0,0)$, $(0,1)$, $(1,0)$, $(1,1)$.
Из этих точек всего одна должна приводить к положительным входам в функцию активации (точка $(1,1)$), и три — к отрицательным.

Нам нужно провести прямую линию так, чтобы положительные входы в функцию активации были отделены от отрицательных входов в функцию активации. Это можно сделать, например, проведя вот такую линию.

Какие могут быть параметры у этой прямой? Их можно подобрать устно: например, $w_1 = 1$, $w_2 = 1$, $b = -1.5$.

Тогда:
- Для $(1,1)$: $1 \cdot 1 + 1 \cdot 1 - 1.5 = 0.5 > 0$ ✅
- Для $(0,0)$: $1 \cdot 0 + 1 \cdot 0 - 1.5 = -1.5 \leq 0$ ✅
- Для $(0,1)$: $1 \cdot 0 + 1 \cdot 1 - 1.5 = -0.5 \leq 0$ ✅
- Для $(1,0)$: $1 \cdot 1 + 1 \cdot 0 - 1.5 = -0.5 \leq 0$ ✅

Однако здесь стоит отметить, что если мы возьмём именно такие параметры, то у нас знаки неравенств будут в обратную сторону. То есть значения отрицательных входов в функцию активации будут с одной стороны прямой, а положительных — с другой. Нас это удовлетворяет.

Итак, одно из решений этой задачи: $w_1 = 1$, $w_2 = 1$, $b = -1.5$.

Стоит, опять же, отметить, что решений такой задачи существует бесконечное множество.


Я попрошу вас решить ещё одну такую же задачу, на этот раз, для оператора "ИЛИ". Для оператора "ИЛИ" таблица истинности будет выглядеть похожим образом, но некоторые результаты у неё будут отличаться. А именно, результатом операции "ИЛИ" будет $1$ в том случае, если хотя бы один вход $1$, и $0$ в том случае, если оба входа $0$.

Таблица истинности:

$$
\begin{array}{cc|c}
x_1 & x_2 & x_1 \ \text{ИЛИ} \ x_2 \\
\hline
0 & 0 & 0 \\
0 & 1 & 1 \\
1 & 0 & 1 \\
1 & 1 & 1 \\
\end{array}
$$

Итак, какими должны быть веса нейрона для того, чтобы выполнялась вот эта таблица истинности?  
Модель нейрона:

$$
y = f(w_1 x_1 + w_2 x_2 + b)
$$

с пороговой функцией активации:

$$
f(z) = 
\begin{cases}
1, & \text{если } z > 0, \\
0, & \text{если } z \leq 0.
\end{cases}
$$

Неравенства:
1. $w_1 \cdot 0 + w_2 \cdot 0 + b \leq 0$
2. $w_1 \cdot 0 + w_2 \cdot 1 + b > 0$
3. $w_1 \cdot 1 + w_2 \cdot 0 + b > 0$
4. $w_1 \cdot 1 + w_2 \cdot 1 + b > 0$

Одно из возможных решений: $w_1 = 1$, $w_2 = 1$, $b = -0.5$.

---

Мы рассмотрим ещё одну операцию, а именно **"исключающее или" (XOR)**. Таблица истинности для этой операции будет следующей:

$$
\begin{array}{cc|c}
x_1 & x_2 & x_1 \oplus x_2 \\
\hline
0 & 0 & 0 \\
0 & 1 & 1 \\
1 & 0 & 1 \\
1 & 1 & 0 \\
\end{array}
$$

Тут будет две единицы в том случае, когда только один из входов $1$, и два нуля, когда оба входа одинаковы.

Задача: нужно сделать нейрон, у которого будет такая таблица истинности. Опять же, нейрон можно делать таким же образом: у него будет два входа и один выход, и нам нужно подобрать три параметра. **Возможно ли это?**

Давайте запишем неравенства:
1. $w_1 \cdot 0 + w_2 \cdot 0 + b \leq 0$
2. $w_1 \cdot 0 + w_2 \cdot 1 + b > 0$
3. $w_1 \cdot 1 + w_2 \cdot 0 + b > 0$
4. $w_1 \cdot 1 + w_2 \cdot 1 + b \leq 0$

Если мы попытаемся решить эту систему неравенств, у нас будет противоречие. В чем же дело? Давайте попробуем воспользоваться графическими рассуждениями. Итак, у нас четыре варианта входа: два минуса ($(0,0)$ и $(1,1)$) и два плюса ($(0,1)$ и $(1,0)$). Можно ли разделить эти точки, отделив минусы от плюсов одной прямой? **Кажется, что нельзя**.

Задача "исключающего или" всё же имеет решение, если использовать несколько нейронов. Операцию "исключающего или" можно представить в виде комбинации уже полученных нами операций. А именно, "исключающее или" между $x$ и $y$ это:
\[
(x \ \text{И} \ \neg y) \ \text{ИЛИ} \ (\neg x \ \text{И} \ y)
\]

Таким образом, операцию "исключающего или" можно сделать из нескольких нейронов. Например, используя три нейрона:
1. Нейрон для $\neg x$ (НЕ $x$)
2. Нейрон для $\neg y$ (НЕ $y$)
3. Нейрон для $(\neg x \ \text{И} \ y)$
4. Нейрон для $(x \ \text{И} \ \neg y)$
5. Нейрон для ИЛИ от результатов 3 и 4

Или компактнее (всего три нейрона):
$$
\text{XOR}(x_1, x_2) = f\Big( 1.0 \cdot f(-1.0 \cdot x_1 + 1.0 \cdot x_2 - 0.5) + 1.0 \cdot f(1.0 \cdot x_1 - 1.0 \cdot x_2 - 0.5) - 0.5 \Big)
$$

где $f$ — пороговая функция активации.

---

**Какой вывод мы должны сделать из этого?**  
Внезапно, элементы, которые до этого давали линейную разделяющую поверхность, в комбинации дают нелинейную разделяющую поверхность. То есть мы разделили выборку, которая была до этого линейно неразделимой.

Стоит отметить, что вместо пяти нейронов, как мы делали здесь, можно использовать всего три. Например, как в выражении выше.

---

**Запись нейронной сети для XOR (три нейрона):**

```
neuron(1.0 * neuron(-1.0*x1 + 1.0*x2 - 0.5) + 1.0 * neuron(1.0*x1 - 1.0*x2 - 0.5) - 0.5)
```

где `neuron(z)` обозначает пороговую функцию активации, применяемую к выражению `z`.
